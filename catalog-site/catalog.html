<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agent Universe</title>

    <!-- Favicon (optional) -->
    <link rel="icon" type="image/png" href="img/favicon.png" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bungee&family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #0b0f14;
        --panel: rgba(255, 255, 255, 0.04);
        --panel2: rgba(255, 255, 255, 0.06);
        --border: rgba(255, 255, 255, 0.10);
        --text: rgba(255, 255, 255, 0.92);
        --muted: rgba(255, 255, 255, 0.68);
        --accent1: #3be4ff;
        --accent2: #ff4fd8;
        --radius: 22px;

        --font-display: "Bungee", system-ui, sans-serif;
        --font-title: "Poppins", system-ui, sans-serif;
        --font-body: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font-family: var(--font-body);
        line-height: 1.45;
      }
      .wrap { max-width: 1160px; margin: 0 auto; padding: 28px 18px 70px; }

      /* Top bar */
      .topbar { display: flex; align-items: center; justify-content: space-between; gap: 12px; margin-bottom: 18px; }
      .brand { display: inline-flex; align-items: center; gap: 12px; text-decoration: none; color: var(--text); }
      .logo {
        width: 36px; height: 36px;
        display: block;
        /* IMPORTANT: no rounding so you can “snip” cleanly */
        border-radius: 0;
        object-fit: contain;
        background: transparent;
      }
      .brandStack { display: flex; flex-direction: column; gap: 2px; }
      .brandName { font-family: var(--font-display); letter-spacing: 0.8px; font-size: 22px; line-height: 1; }
      .brandTag { font-size: 13px; color: var(--muted); }

      .nav { display: inline-flex; align-items: center; gap: 10px; }
      .chipLink {
        padding: 10px 12px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel2), var(--panel));
        color: var(--muted);
        text-decoration: none;
        font-size: 12px;
      }
      .chipLink:hover { border-color: rgba(255,255,255,0.20); color: rgba(255,255,255,0.85); }

      /* Hero */
      .hero {
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel2), var(--panel));
        border-radius: var(--radius);
        padding: 26px;
        overflow: hidden;
        position: relative;
      }
      .hero:before {
        content: "";
        position: absolute;
        inset: -220px -220px auto auto;
        width: 420px; height: 420px;
        border-radius: 999px;
        background:
          radial-gradient(circle, rgba(255,79,216,0.12), rgba(255,79,216,0) 55%),
          radial-gradient(circle, rgba(59,228,255,0.10), rgba(59,228,255,0) 60%);
        pointer-events: none;
      }
      .kicker { display: inline-flex; align-items: center; gap: 10px; color: var(--muted); font-size: 12px; margin-bottom: 10px; }
      .kicker .spark { width: 10px; height: 10px; border-radius: 99px; background: var(--accent2); box-shadow: 0 0 14px rgba(255,79,216,0.25); }

      h1 {
        font-family: var(--font-display);
        letter-spacing: 0.6px;
        margin: 0;
        font-size: clamp(30px, 4vw, 44px);
        line-height: 1.05;
      }
      .heroCopy { margin: 14px 0 0; max-width: 78ch; color: rgba(255,255,255,0.82); font-size: 15px; }

      .heroActions { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 18px; align-items: center; }

      .btn {
        border: 1px solid rgba(255,255,255,0.18);
        background: rgba(255,255,255,0.06);
        color: rgba(255,255,255,0.92);
        border-radius: 999px;
        padding: 11px 14px;
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
      }
      .btn.primary { border-color: rgba(59,228,255,0.35); box-shadow: 0 0 0 2px rgba(59,228,255,0.10) inset; }
      .btn:hover { border-color: rgba(255,255,255,0.24); }
      .btn.primary:hover { border-color: rgba(59,228,255,0.55); }

      .code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
        color: rgba(255,255,255,0.85);
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.10);
        padding: 2px 6px;
        border-radius: 8px;
      }

      .notice {
        margin-top: 12px;
        border: 1px dashed rgba(255,255,255,0.22);
        border-radius: 18px;
        padding: 12px 14px;
        color: var(--muted);
        font-size: 12px;
      }

      /* Stats */
      .stats { margin-top: 14px; display: grid; grid-template-columns: repeat(12, 1fr); gap: 12px; }
      .stat {
        grid-column: span 4;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel2), var(--panel));
        border-radius: var(--radius);
        padding: 14px 16px;
      }
      @media (max-width: 900px) { .stat { grid-column: span 12; } }
      .statLabel { color: var(--muted); font-size: 12px; margin: 0; }
      .statValue { margin: 6px 0 0; font-family: var(--font-display); letter-spacing: 0.3px; font-size: 20px; line-height: 1.1; }

      /* Section */
      .section {
        margin-top: 22px;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel2), var(--panel));
        border-radius: var(--radius);
        padding: 18px;
      }
      .sectionTitle { font-family: var(--font-display); letter-spacing: 0.4px; font-size: 16px; margin: 0; }
      .sectionCopy { margin: 10px 0 0; color: rgba(255,255,255,0.78); font-size: 14px; max-width: 90ch; }

      /* Controls */
      .controls { margin-top: 14px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
      .search {
        flex: 1 1 280px; min-width: 220px;
        border: 1px solid rgba(255,255,255,0.14);
        background: rgba(255,255,255,0.04);
        color: rgba(255,255,255,0.92);
        border-radius: 999px;
        padding: 11px 14px;
        outline: none;
        font-size: 13px;
      }
      .search::placeholder { color: rgba(255,255,255,0.45); }
      select {
        border: 1px solid rgba(255,255,255,0.14);
        background: rgba(255,255,255,0.04);
        color: rgba(255,255,255,0.92);
        border-radius: 999px;
        padding: 11px 14px;
        outline: none;
        font-size: 13px;
      }
      .divider { height: 1px; background: rgba(255,255,255,0.06); margin: 14px 0; }

      /* Cards */
      .agentGrid { margin-top: 14px; display: grid; grid-template-columns: repeat(12, 1fr); gap: 12px; }
      .agentCard {
        grid-column: span 4;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel2), var(--panel));
        border-radius: 22px;
        padding: 16px;
        position: relative;
        overflow: hidden;
      }
      .agentCard:before {
        content: "";
        position: absolute;
        inset: -140px auto auto -140px;
        width: 260px; height: 260px;
        border-radius: 999px;
        background: radial-gradient(circle, rgba(59,228,255,0.10), rgba(59,228,255,0) 60%);
        pointer-events: none;
      }
      @media (max-width: 1000px) { .agentCard { grid-column: span 6; } }
      @media (max-width: 720px) { .agentCard { grid-column: span 12; } }

      .agentTop { display: grid; grid-template-columns: 72px 1fr; gap: 12px; align-items: start; }
      .avatarFrame {
        width: 72px; height: 72px;
        border-radius: 18px;
        border: 1px solid rgba(255,255,255,0.14);
        background: rgba(255,255,255,0.03);
        overflow: hidden;
        position: relative;
      }
      .avatar { width: 100%; height: 100%; object-fit: cover; display: block; background: var(--bg); }

      .agentTitleRow { display: flex; align-items: baseline; justify-content: space-between; gap: 10px; }
      .agentName {
        margin: 0;
        font-family: var(--font-title);
        font-weight: 700;
        letter-spacing: 0.2px;
        font-size: 16px;
        line-height: 1.2;
      }
      .badge {
        border: 1px solid rgba(255,255,255,0.16);
        background: rgba(255,255,255,0.04);
        color: rgba(255,255,255,0.78);
        font-size: 11px;
        padding: 6px 10px;
        border-radius: 999px;
        white-space: nowrap;
      }

      .agentMeta { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
      .pill {
        display: inline-flex;
        align-items: center;
        padding: 7px 10px;
        border-radius: 999px;
        border: 1px solid rgba(255,255,255,0.12);
        background: rgba(255,255,255,0.03);
        color: rgba(255,255,255,0.82);
        font-size: 12px;
      }
      .agentDesc { margin: 10px 0 0; color: rgba(255,255,255,0.78); font-size: 13px; max-width: 60ch; }

      .agentStats { margin-top: 12px; display: grid; grid-template-columns: repeat(12, 1fr); gap: 10px; }
      .statMini {
        grid-column: span 4;
        border: 1px solid rgba(255,255,255,0.10);
        background: rgba(255,255,255,0.03);
        border-radius: 16px;
        padding: 10px 10px;
      }
      .statMiniLabel { color: rgba(255,255,255,0.60); font-size: 11px; }
      .statMiniValue { margin-top: 5px; font-weight: 700; font-size: 12px; color: rgba(255,255,255,0.88); }

      .agentSection { margin-top: 12px; }
      .agentSectionLabel {
        font-family: var(--font-title);
        font-weight: 600;
        font-size: 11px;
        color: rgba(255,255,255,0.60);
        margin-bottom: 6px;
        letter-spacing: 0.2px;
      }
      .chipsRow { display: flex; flex-wrap: wrap; gap: 8px; }
      .chip {
        display: inline-flex;
        align-items: center;
        padding: 7px 10px;
        border-radius: 999px;
        border: 1px solid rgba(255,255,255,0.10);
        background: rgba(255,255,255,0.02);
        color: rgba(255,255,255,0.78);
        font-size: 12px;
      }
      .mutedSmall { color: rgba(255,255,255,0.55); font-size: 12px; }

      .agentActions { margin-top: 14px; display: flex; gap: 10px; flex-wrap: wrap; }

      /* Background logo watermark */
.bg-logo {
  position: fixed;
  top: -80px;
  left: -80px;

  width: min(65vw, 720px);
  height: auto;

  opacity: 0.08;                 /* subtle */
  filter: saturate(110%) blur(0.5px);

  pointer-events: none;          /* never clickable */
  user-select: none;

  z-index: 0;                    /* behind content */
}

/* Ensure all real content stays above */
.wrap,
.topbar,
.hero,
.section {
  position: relative;
  z-index: 1;
}
    </style>
  </head>

  <body>
    <!-- Decorative background logo -->
    <img
    src="img/AgentUniverseLogo.png"
    alt=""
    aria-hidden="true"
    class="bg-logo"
    />
    <div class="wrap">
      <div class="topbar">
        <a class="brand" href="#about">
          <div class="brandStack">
            <div class="brandName">Agent Universe</div>
            <div class="brandTag">Role-first agent catalogue</div>
          </div>
        </a>

        <nav class="nav">
          <a class="chipLink" href="#catalogue">Catalogue</a>
          <a class="chipLink" href="#how">How it works</a>
          <a class="chipLink" href="#about">About</a>
        </nav>
      </div>

      <section class="hero" id="about">
        <div class="kicker"><span class="spark"></span> A role-first catalogue of AI agents</div>
        <h1>Find the right agent for the right job.</h1>
        <p class="heroCopy">
          <strong>Agent Universe</strong> is a curated catalogue of practical AI agents organised by
          <strong>business role</strong> and <strong>sector</strong>—so teams can move from “interesting idea” to
          “deployable solution” with less guesswork.
        </p>

        <div class="heroActions">
          <a class="btn primary" href="#catalogue">Explore</a>
          <button class="btn" id="reloadBtn" type="button">Reload</button>
          <span class="code" id="dataSource">—</span>
        </div>

        <div class="notice">Status: <span id="statusLine">Waiting for data…</span></div>
      </section>

      <div class="stats">
        <div class="stat">
          <p class="statLabel">Sectors</p>
          <p class="statValue" id="statSectors">—</p>
        </div>
        <div class="stat">
          <p class="statLabel">Roles</p>
          <p class="statValue" id="statRoles">—</p>
        </div>
        <div class="stat">
          <p class="statLabel">Agents</p>
          <p class="statValue" id="statAgents">—</p>
        </div>
      </div>

      <section class="section" id="how">
        <h2 class="sectionTitle">How it works</h2>
        <p class="sectionCopy">
          Start with the role you’re designing for. Browse agents designed for that role, then filter by friction and
          required capabilities.
        </p>
      </section>

      <section class="section" id="catalogue">
        <h2 class="sectionTitle">Catalogue</h2>
        <p class="sectionCopy">
          Search is live. Filters are instant. Avatars are loaded from <span class="code">img/</span> based on role (e.g. <span class="code">FacilitiesManager.png</span>).
        </p>

        <div class="controls">
          <input class="search" id="searchInput" placeholder="Search agents (name, role, sector, tags)..." />
          <select id="roleFilter">
            <option value="">All roles</option>
          </select>
          <select id="sectorFilter">
            <option value="">All sectors</option>
          </select>
          <button class="btn" id="clearBtn" type="button">Clear</button>
        </div>

        <div class="divider"></div>

        <div id="cardsMount"></div>
      </section>
    </div>

    <script>
      const REMOTE_CATALOG_URL =
        "https://raw.githubusercontent.com/stjeffer/agent-universe/main/catalog.json";

      const LOCAL_AVATAR_BASE = "img";

      const PLACEHOLDER_AVATAR =
        "data:image/svg+xml;utf8," +
        encodeURIComponent(`
        <svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256">
          <rect width="256" height="256" rx="28" fill="#0B0F14"/>
          <circle cx="78" cy="84" r="56" fill="rgba(59,228,255,0.16)"/>
          <circle cx="180" cy="180" r="70" fill="rgba(255,79,216,0.10)"/>
          <path d="M70 160c22-30 94-30 116 0" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="10" stroke-linecap="round"/>
        </svg>
      `);

      const els = {
        sectors: document.getElementById("statSectors"),
        roles: document.getElementById("statRoles"),
        agents: document.getElementById("statAgents"),
        dataSource: document.getElementById("dataSource"),
        status: document.getElementById("statusLine"),
        reload: document.getElementById("reloadBtn"),
        mount: document.getElementById("cardsMount"),
        search: document.getElementById("searchInput"),
        roleFilter: document.getElementById("roleFilter"),
        sectorFilter: document.getElementById("sectorFilter"),
        clear: document.getElementById("clearBtn"),
      };

      let ALL_AGENTS = [];

      function setStatus(msg) { els.status.textContent = msg; }

      function setStatsFromCatalog(catalog) {
        const totals = catalog?.summary?.totals;
        if (totals) {
          els.sectors.textContent = String(totals.sectors ?? "—");
          els.roles.textContent = String(totals.roles ?? "—");
          els.agents.textContent = String(totals.agents ?? "—");
          return;
        }
        const agents = Array.isArray(catalog?.agents) ? catalog.agents : [];
        const sectors = new Set(agents.map(a => a.sector_name || a.sector).filter(Boolean));
        const roles = new Set(agents.map(a => a.role_name || a.role).filter(Boolean));
        els.sectors.textContent = String(sectors.size || "—");
        els.roles.textContent = String(roles.size || "—");
        els.agents.textContent = String(agents.length || "—");
      }

      function esc(s) {
        return String(s ?? "")
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function titleCaseFromSlugOrUnderscore(value) {
        if (!value) return "";
        return String(value)
          .replaceAll("_", " ")
          .replaceAll("-", " ")
          .split(/\s+/)
          .filter(Boolean)
          .map(w => w.charAt(0).toUpperCase() + w.slice(1))
          .join(" ");
      }

      function roleToAvatarFilename(agent) {
        const roleName = agent?.role_name || titleCaseFromSlugOrUnderscore(agent?.role || "");
        const pascal = roleName
          .replace(/[^a-zA-Z0-9\s]/g, "")
          .trim()
          .split(/\s+/)
          .filter(Boolean)
          .map(w => w.charAt(0).toUpperCase() + w.slice(1))
          .join("");
        return pascal ? `${pascal}.png` : null;
      }

      function avatarUrl(agent) {
        const file = roleToAvatarFilename(agent);
        return file ? `${LOCAL_AVATAR_BASE}/${encodeURIComponent(file)}` : PLACEHOLDER_AVATAR;
      }

      function pill(label, kind = "chip") {
        const cls = kind === "pill" ? "pill" : "chip";
        return `<span class="${cls}">${esc(label)}</span>`;
      }

      function renderAgentCard(agent) {
        const role = agent.role_name || titleCaseFromSlugOrUnderscore(agent.role);
        const sector = agent.sector_name || titleCaseFromSlugOrUnderscore(agent.sector);

        const frictions = Array.isArray(agent.friction_addressed) ? agent.friction_addressed : [];
        const required = Array.isArray(agent.capabilities_required) ? agent.capabilities_required : [];
        const optional = Array.isArray(agent.capabilities_optional) ? agent.capabilities_optional : [];

        const timeSaved = typeof agent.time_saved_hours_per_week === "number" ? `${agent.time_saved_hours_per_week}h/wk` : "—";
        const setup = typeof agent.setup_time_minutes === "number" ? `${agent.setup_time_minutes} min setup` : "—";
        const complexity = agent.complexity ? titleCaseFromSlugOrUnderscore(agent.complexity) : "—";

        return `
          <article class="agentCard" data-agent-id="${esc(agent.id)}">
            <div class="agentTop">
              <div class="avatarFrame">
                <img class="avatar" alt="${esc(role)} avatar" src="${esc(avatarUrl(agent))}" loading="lazy"
                  onerror="this.onerror=null; this.src='${PLACEHOLDER_AVATAR}';" />
              </div>

              <div>
                <div class="agentTitleRow">
                  <h3 class="agentName">${esc(agent.name)}</h3>
                  <span class="badge">${esc(complexity)}</span>
                </div>

                <div class="agentMeta">
                  ${pill(role, "pill")}
                  ${pill(sector, "pill")}
                  ${agent.has_actions ? pill("Has actions", "pill") : pill("No actions", "pill")}
                </div>

                <p class="agentDesc">${esc(agent.description)}</p>
              </div>
            </div>

            <div class="agentStats">
              <div class="statMini">
                <div class="statMiniLabel">Time saved</div>
                <div class="statMiniValue">${esc(timeSaved)}</div>
              </div>
              <div class="statMini">
                <div class="statMiniLabel">Setup</div>
                <div class="statMiniValue">${esc(setup)}</div>
              </div>
              <div class="statMini">
                <div class="statMiniLabel">Required</div>
                <div class="statMiniValue">${esc(required.length)} capability</div>
              </div>
            </div>

            <div class="agentSection">
              <div class="agentSectionLabel">Friction addressed</div>
              <div class="chipsRow">
                ${frictions.length ? frictions.map(f => pill(titleCaseFromSlugOrUnderscore(f))).join("") : `<span class="mutedSmall">—</span>`}
              </div>
            </div>

            <div class="agentSection">
              <div class="agentSectionLabel">Required</div>
              <div class="chipsRow">
                ${required.length ? required.map(c => pill(c, "pill")).join("") : `<span class="mutedSmall">—</span>`}
              </div>
            </div>

            <div class="agentSection">
              <div class="agentSectionLabel">Optional</div>
              <div class="chipsRow">
                ${optional.length ? optional.map(c => pill(c, "pill")).join("") : `<span class="mutedSmall">—</span>`}
              </div>
            </div>

            <div class="agentActions">
              <button class="btn primary" type="button" data-action="copy" data-id="${esc(agent.id)}">Copy ID</button>
              <button class="btn" type="button" data-action="path" data-path="${esc(agent.path || "")}">Copy Path</button>
            </div>
          </article>
        `;
      }

      function renderAgentGrid(agents) {
        els.mount.innerHTML = `
          <div class="agentGrid" aria-label="Agent catalogue">
            ${agents.map(renderAgentCard).join("")}
          </div>
        `;
      }

      function uniqueSorted(arr) {
        return [...new Set(arr.filter(Boolean))].sort((a,b) => String(a).localeCompare(String(b)));
      }

      function populateFilters(agents) {
        const roles = uniqueSorted(agents.map(a => a.role_name || titleCaseFromSlugOrUnderscore(a.role)));
        const sectors = uniqueSorted(agents.map(a => a.sector_name || titleCaseFromSlugOrUnderscore(a.sector)));

        els.roleFilter.innerHTML =
          `<option value="">All roles</option>` +
          roles.map(r => `<option value="${esc(r)}">${esc(r)}</option>`).join("");

        els.sectorFilter.innerHTML =
          `<option value="">All sectors</option>` +
          sectors.map(s => `<option value="${esc(s)}">${esc(s)}</option>`).join("");
      }

      // ✅ Search works here: live filtering on input + dropdowns
      function applyFilters() {
        const q = (els.search.value || "").toLowerCase().trim();
        const role = els.roleFilter.value;
        const sector = els.sectorFilter.value;

        const filtered = ALL_AGENTS.filter(a => {
          const roleName = a.role_name || titleCaseFromSlugOrUnderscore(a.role);
          const sectorName = a.sector_name || titleCaseFromSlugOrUnderscore(a.sector);

          if (role && roleName !== role) return false;
          if (sector && sectorName !== sector) return false;
          if (!q) return true;

          const hay = [
            a.name, a.description, roleName, sectorName,
            ...(Array.isArray(a.tags) ? a.tags : []),
            ...(Array.isArray(a.friction_addressed) ? a.friction_addressed : []),
            ...(Array.isArray(a.capabilities_required) ? a.capabilities_required : []),
            ...(Array.isArray(a.capabilities_optional) ? a.capabilities_optional : []),
          ].filter(Boolean).join(" ").toLowerCase();

          return hay.includes(q);
        });

        renderAgentGrid(filtered);
        setStatus(`Showing ${filtered.length} of ${ALL_AGENTS.length} agents.`);
      }

      function attachHandlers() {
        els.search.addEventListener("input", applyFilters);
        els.roleFilter.addEventListener("change", applyFilters);
        els.sectorFilter.addEventListener("change", applyFilters);

        els.clear.addEventListener("click", () => {
          els.search.value = "";
          els.roleFilter.value = "";
          els.sectorFilter.value = "";
          applyFilters();
        });

        // Card buttons (delegated)
        els.mount.addEventListener("click", (e) => {
          const btn = e.target.closest("button[data-action]");
          if (!btn) return;

          const action = btn.getAttribute("data-action");

          if (action === "copy") {
            const id = btn.getAttribute("data-id") || "";
            navigator.clipboard?.writeText(id);
            setStatus(`Copied agent id: ${id}`);
          }

          if (action === "path") {
            const p = btn.getAttribute("data-path") || "";
            if (!p) return setStatus("No path available for this agent.");
            navigator.clipboard?.writeText(p);
            setStatus(`Copied agent path: ${p}`);
          }
        });
      }

      async function fetchJson(url) {
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status} ${res.statusText}`);
        return res.json();
      }

      async function loadCatalog() {
        setStatus("Loading catalog.json…");

        // Try local first, then GitHub raw (useful if running from a server)
        const localUrl = "./catalog.json";
        const remoteUrl = REMOTE_CATALOG_URL;

        try {
          const data = await fetchJson(`${localUrl}?t=${Date.now()}`);
          els.dataSource.textContent = localUrl;
          return data;
        } catch {
          const data = await fetchJson(`${remoteUrl}?t=${Date.now()}`);
          els.dataSource.textContent = "GitHub raw";
          return data;
        }
      }

      async function boot() {
        const catalog = await loadCatalog();
        setStatsFromCatalog(catalog);

        ALL_AGENTS = Array.isArray(catalog.agents) ? catalog.agents : [];
        populateFilters(ALL_AGENTS);
        renderAgentGrid(ALL_AGENTS);
        setStatus(`Showing ${ALL_AGENTS.length} agents.`);
      }

      attachHandlers();
      els.reload.addEventListener("click", boot);
      boot();
    </script>
  </body>
</html>